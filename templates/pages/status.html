{% extends 'base.html' %}
{% load static %}

{% block title %}Check Status - Greatness Community Relief{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="bg-light py-5">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold text-gradient mb-3">Check Application Status</h1>
                <p class="lead text-muted">
                    Track your relief package application and get updates on approval status, 
                    pickup details, and QR code access.
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Status Check Form -->
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <div class="form-container">
                    <h4 class="mb-4 text-center">Enter Your Details</h4>
                    
                    <form id="status-form">
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number *</label>
                            <input type="tel" class="form-control form-control-lg" id="phone" name="phone" 
                                   placeholder="080XXXXXXXX" required>
                            <div class="form-text">Enter the phone number you used in your application</div>
                        </div>
                        
                        <div class="text-center">
                            <span class="text-muted">OR</span>
                        </div>
                        
                        <div class="mb-4">
                            <label for="reference" class="form-label">Reference Number (Optional)</label>
                            <input type="text" class="form-control form-control-lg" id="reference" name="reference" 
                                   placeholder="REF-XXXXXXXXX">
                            <div class="form-text">If you have a reference number from your application</div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-lg w-100">
                            <i class="bi bi-search me-2"></i>Check Status
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Status Result -->
        <div class="row justify-content-center mt-5">
            <div class="col-lg-8">
                <div id="status-result">
                    <!-- Results will be populated here -->
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Demo Status Examples -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row justify-content-center mb-5">
            <div class="col-lg-8 text-center">
                <h3 class="fw-bold mb-3">Application Status Guide</h3>
                <p class="text-muted">Here's what each status means and what to expect next:</p>
            </div>
        </div>
        
        <div class="row g-4">
            <!-- Under Review -->
            <div class="col-lg-6">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="text-center mb-3">
                            <span class="status-badge status-pending">Under Review</span>
                        </div>
                        <h6>Application Submitted</h6>
                        <p class="text-muted small mb-3">
                            Your application has been received and is being reviewed by our care team. 
                            This typically takes 1-2 business days.
                        </p>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-clock-history text-warning me-2"></i>
                            <small class="text-muted">Expected response: 1-2 days</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Approved -->
            <div class="col-lg-6">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="text-center mb-3">
                            <span class="status-badge status-approved">Approved - Ready for Pickup</span>
                        </div>
                        <h6>Application Approved</h6>
                        <p class="text-muted small mb-3">
                            Great news! Your application has been approved. You'll receive your QR code 
                            and pickup details via SMS and email.
                        </p>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-check-circle text-success me-2"></i>
                            <small class="text-muted">QR code and pickup details available</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ready for Pickup -->
            <div class="col-lg-6">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="text-center mb-3">
                            <span class="status-badge status-ready">Ready for Pickup</span>
                        </div>
                        <h6>Package Prepared</h6>
                        <p class="text-muted small mb-3">
                            Your relief package is ready and waiting for you at the pickup location. 
                            Present your QR code to collect your package.
                        </p>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-gift text-info me-2"></i>
                            <small class="text-muted">Visit pickup location with QR code</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Collected -->
            <div class="col-lg-6">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="text-center mb-3">
                            <span class="status-badge status-collected">Collected</span>
                        </div>
                        <h6>Package Collected</h6>
                        <p class="text-muted small mb-3">
                            You have successfully collected your relief package. Thank you for using 
                            our community support program.
                        </p>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-check2-all text-success me-2"></i>
                            <small class="text-muted">You can apply again after 21 days</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Demo Status Display (for demonstration) -->
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card border-primary">
                    <div class="card-header bg-primary text-white text-center">
                        <h5 class="mb-0">Demo Status Result</h5>
                        <small>This is a sample status display</small>
                    </div>
                    <div class="card-body">
                        <div class="text-center mb-4">
                            <span class="status-badge status-approved">Approved - Ready for Pickup</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Package Details</h6>
                                <p class="text-muted">Medium Family Basic Package</p>
                                <p class="small">
                                    <strong>Contents:</strong> 10kg Rice, 5kg Beans, 2L Vegetable Oil, 
                                    1kg Salt, 1kg Sugar + ₦8,000 Cash
                                </p>
                            </div>
                            <div class="col-md-6">
                                <h6>Pickup Information</h6>
                                <p class="text-muted">
                                    <i class="bi bi-calendar me-2"></i>Saturday, September 15, 2024<br>
                                    <i class="bi bi-clock me-2"></i>10:00 AM - 12:00 PM<br>
                                    <i class="bi bi-geo-alt me-2"></i>Community Center, Lagos
                                </p>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="text-center">
                            <h6>Your QR Code</h6>
                            <div class="qr-code mb-3">
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=RELIEF-APP-QR123456789" 
                                     alt="QR Code" class="img-fluid">
                            </div>
                            <p class="small text-muted">
                                Reference: <strong>REF-240915001</strong><br>
                                Present this QR code during pickup
                            </p>
                        </div>
                        
                        <hr>
                        
                        <div class="row text-center">
                            <div class="col-md-6">
                                <h6>Contact Person</h6>
                                <p class="text-muted">
                                    Mrs. Sarah Johnson<br>
                                    <i class="bi bi-telephone me-1"></i>+234 812 345 6789
                                </p>
                            </div>
                            <div class="col-md-6">
                                <h6>Important Notes</h6>
                                <p class="small text-muted">
                                    • Bring a valid ID<br>
                                    • QR code expires after pickup<br>
                                    • Contact us if you can't make it
                                </p>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4">
                            <a href="{% url 'pickup' %}" class="btn btn-success btn-lg">
                                <i class="bi bi-arrow-right me-2"></i>View Full Pickup Details
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Help Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body text-center">
                        <i class="bi bi-question-circle display-4 text-primary mb-3"></i>
                        <h4 class="fw-bold mb-3">Can't Find Your Application?</h4>
                        <p class="text-muted mb-4">
                            If you can't find your application status or are experiencing issues, 
                            here are some things you can try:
                        </p>
                        
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="p-3">
                                    <i class="bi bi-telephone-fill text-primary mb-2 d-block"></i>
                                    <h6>Double-Check Details</h6>
                                    <p class="small text-muted">
                                        Ensure you're using the same phone number from your application
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-3">
                                    <i class="bi bi-clock-history text-primary mb-2 d-block"></i>
                                    <h6>Wait for Processing</h6>
                                    <p class="small text-muted">
                                        Applications take 1-2 business days to review
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-3">
                                    <i class="bi bi-headset text-primary mb-2 d-block"></i>
                                    <h6>Contact Support</h6>
                                    <p class="small text-muted">
                                        Reach out to our support team for assistance
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex flex-wrap justify-content-center gap-3 mt-4">
                            <a href="tel:+2348123456789" class="btn btn-primary">
                                <i class="bi bi-telephone me-2"></i>Call Support
                            </a>
                            <a href="mailto:support@ourgcrelief.com" class="btn btn-outline-primary">
                                <i class="bi bi-envelope me-2"></i>Email Us
                            </a>
                            <a href="{% url 'apply' %}" class="btn btn-success">
                                <i class="bi bi-plus-circle me-2"></i>New Application
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FAQ Section -->
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h3 class="text-center fw-bold mb-5">Frequently Asked Questions</h3>
                
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                                    data-bs-target="#faq1">
                                How long does it take to get approved?
                            </button>
                        </h2>
                        <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Most applications are reviewed within 1-2 business days. Emergency applications 
                                are fast-tracked and may be approved within hours.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                                    data-bs-target="#faq2">
                                What if I miss my pickup time?
                            </button>
                        </h2>
                        <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Contact our support team as soon as possible to reschedule. We understand 
                                that emergencies happen and will work with you to find an alternative time.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                                    data-bs-target="#faq3">
                                Can someone else pick up my package?
                            </button>
                        </h2>
                        <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Yes, but they must present the QR code and a valid ID. Please inform us 
                                in advance who will be collecting the package on your behalf.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                                    data-bs-target="#faq4">
                                When can I apply again?
                            </button>
                        </h2>
                        <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                You can submit a new application 21 days after your last package collection. 
                                This helps ensure fair distribution among all community members.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize status checker
    new window.CommunityRelief.StatusChecker();
    
    // Phone number validation
    document.getElementById('phone').addEventListener('input', function() {
        const phone = this.value;
        if (phone && !window.CommunityRelief.validatePhone(phone)) {
            this.setCustomValidity('Please enter a valid Nigerian phone number (e.g., 08012345678)');
        } else {
            this.setCustomValidity('');
        }
    });
});
</script>
{% endblock %}